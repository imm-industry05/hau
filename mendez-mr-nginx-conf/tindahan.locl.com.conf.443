
upstream tindahan.locl.com_443 {
  server 10.10.0.4:3000 fail_timeout=0;
  server 10.10.0.5:3001 fail_timeout=0;
}

server {
    # Listen port
    listen 80;

    # URL
    server_name tindahan.locl.com;

    # Log files
    access_log  /var/log/nginx/tindahan.locl.com_access.log;
    error_log   /var/log/nginx/tindahan.locl.com_error.log;


     return         301 https://$server_name$request_uri;
}

server {
    listen              443;
    server_name         tindahan.locl.com;

    access_log          /var/log/nginx/tindahan.locl.com_ssl_access.log;
    error_log           /var/log/nginx/tindahan.locl.com_ssl_error.log;


    ssl                 on;
    ssl_certificate     /etc/nginx/conf.d/cert/tindahan.locl.com.crt;
    ssl_certificate_key /etc/nginx/conf.d/cert/tindahan.locl.com.key;

    location / {
        proxy_pass                 http://tindahan.locl.com_443;
        proxy_http_version 1.1;
        proxy_set_header Connection "";

        proxy_redirect     off;
        proxy_set_header   Host $host;
        proxy_set_header   X-Real-IP $remote_addr;
        proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header   X-Forwarded-Host $server_name;

        # Show error pages from ?? when down
        # proxy_next_upstream error timeout http_502 http_503 http_504;
        # error_page   502 503 504   https://s3.amazonaws.com/sample.com/maint;
   }
}